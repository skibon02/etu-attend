сделать last-activity data time у юзера
разделить бг таску на 2 параллельных (основной мердж для самой несвежей группы и новые реквесты)

user attendance schedule periodic cleanup